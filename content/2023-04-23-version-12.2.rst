Kiwi TCMS 12.2
##############

:headline: security updates, improvements, bug fixes, API changes and new translations
:date: 2023-04-23 15:00
:comments: true
:tags: releases


We're happy to announce Kiwi TCMS version 12.2!

**IMPORTANT:** this release contains security related updates, general improvements,
bug fixes, some API changes and new translations!

You can explore everything at
`https://public.tenant.kiwitcms.org <https://public.tenant.kiwitcms.org/>`_!


    Supported upgrade paths::

        5.3   (or older) -> 5.3.1
        5.3.1 (or newer) -> 6.0.1
        6.0.1            -> 6.1
        6.1              -> 6.1.1
        6.1.1            -> 6.2 (or newer)

---

    Upstream container images (x86_64)::

        kiwitcms/kiwi   latest  89b8ca5e0f5f    593MB


**IMPORTANT:** version tagged and multi-arch
`container <{filename}pages/containers.markdown>`_ images are available only to
`subscribers </#subscriptions>`_!


Changes since Kiwi TCMS 12.1
----------------------------

Security
~~~~~~~~

- For security reasons updating email address is no longer allowed. Fixes
  `CVE-2023-30544 <https://github.com/kiwitcms/Kiwi/security/advisories/GHSA-7x6q-3v3m-cwjg>`_
- Block uploads of potentially harmful files. Fixes
  `CVE-2023-30613 <https://github.com/kiwitcms/Kiwi/security/advisories/GHSA-fwcf-753v-fgcj>`_


Improvements
~~~~~~~~~~~~

- Update Django from 4.1.7 to 4.1.8
- Update django-attachments from 1.9.1 to 1.11
- Update psycopg2 from 2.9.5 to 2.9.6
- Update pygments from 2.14.0 to 2.15.1
- Update python-gitlab from 3.13.0 to 3.14.0
- Add INFO message for User/Group pages in Admin panel which indicates whether
  the user is viewing records from the main tenant or from an individual tenant
  to avoid confusion
- Add new Execution Dashboard telemetry report. Closes
  `Issue #2918 <https://github.com/kiwitcms/Kiwi/issues/2918>`_
- Add column visibility button on search pages. Fixes
  `Issue #3149 <https://github.com/kiwitcms/Kiwi/issues/3149>`_
- Add CSV, Excel, PDF and Print buttons on search pages. Fixes
  `Issue #3150 <https://github.com/kiwitcms/Kiwi/issues/3150>`_
- Allow manually resetting ``TestRun.stop_date`` when editing page. Refs
  `Issue #3124 <https://github.com/kiwitcms/Kiwi/issues/3124>`_
- Display child test plans on Search Test Plans page. Fixes
  `Issue #2917 <https://github.com/kiwitcms/Kiwi/issues/2917>`_
- Display nested test plans in drop down select widget on Search Test Cases page.
  Fixes `Issue #3134 <https://github.com/kiwitcms/Kiwi/issues/3134>`_
- Display nested test plans in drop down select widget on Telemetry pages
- Display pagination controls for search results both at the top and bottom
- On Search Test Runs page display start/stop timestamp columns. Closes
  `Issue #2306 <https://github.com/kiwitcms/Kiwi/issues/2306>`_
- On Search Test Cases page display results from child test plans. Fixes
  `Issue #3135 <https://github.com/kiwitcms/Kiwi/issues/3135>`_


API
~~~

- ``TestExecution.update()`` method will no longer update ``self.stop_date``
  and ``self.run.stop_date`` fields when status has been changed! The
  appropriate behavior here should be specified by the client calling this API
  method. Refs `Issue #3112 <https://github.com/kiwitcms/Kiwi/issues/3112>`_
- ``TestPlan.filter()`` method now returns the ``children_count`` field.
  Refs `Issue #3134 <https://github.com/kiwitcms/Kiwi/issues/3134>`_,
  `Issue #2917 <https://github.com/kiwitcms/Kiwi/issues/2917>`_
- ``TestExecution.filter()`` method now returns ``status__icon`` &
  ``status__color`` fields


Bug fixes
~~~~~~~~~

- Fix test case filter widget on Test Plan page. Fixes
  `Issue #3137 <https://github.com/kiwitcms/Kiwi/issues/3137>`_
- Disable selection of inactive test plans on New Test Run page. Fixes
  `Issue #3152 <https://github.com/kiwitcms/Kiwi/issues/3152>`_
- Add styled page for attachment upload errors. Fixes
  `Issue #1156 <https://github.com/kiwitcms/Kiwi/issues/1156>`_
- Fix include syntax for ``uwsgi.override`` in ``uwsgi.conf``


Refactoring
~~~~~~~~~~~

- Add additional query parameters for ``updateTestPlanSelectFromProduct()``
- Add ``preProcessData`` callback to ``updateTestPlanSelectFromProduct()``
- Remove unused ``telemetry.css`` file
- Remove unused parameter from ``updateTestPlanSelectFromProduct()``
- Replace hand-crafted pagination controls with the ones built into DataTables
- Replace useless ``form_errors_to_list()`` function
- Skip RobotFramework tests on aarch64 b/c of Selenium error, tested on x86_64
- Update node_modules/webpack from 5.76.3 to 5.80.0
- Update node_modules/eslint from 8.37.0 to 8.38.0


Translations
~~~~~~~~~~~~

- Updated `Russian translation <https://crowdin.com/project/kiwitcms/ru#>`_
- Updated `Slovenian translation <https://crowdin.com/project/kiwitcms/sl#>`_


Kiwi TCMS Enterprise v12.2-mt
-----------------------------

- Based on Kiwi TCMS v12.2
- Update social-auth-app-django from 5.0.0 to 5.2.0

    Private images::

        quay.io/kiwitcms/version            12.2 (aarch64)          7e88241f7476    23 Apr 2023     601MB
        quay.io/kiwitcms/version            12.2 (x86_64)           89b8ca5e0f5f    23 Apr 2023     592MB
        quay.io/kiwitcms/enterprise         12.2-mt (aarch64)       7f2a05cf9888    23 Apr 2023     843MB
        quay.io/kiwitcms/enterprise         12.2-mt (x86_64)        c4f518a20c58    23 Apr 2023     833MB


**IMPORTANT:** version tagged, multi-arch and Enterprise
`container <{filename}pages/containers.markdown>`_ images are available only to
`subscribers </#subscriptions>`_!


How to upgrade
---------------

`Backup <{filename}2018-07-30-docker-backup.markdown>`_ first!
Then execute the commands::

    cd path/containing/docker-compose/
    docker-compose down
    docker-compose pull
    docker-compose up -d
    docker exec -it kiwi_web /Kiwi/manage.py upgrade

Refer to
`our documentation <https://kiwitcms.readthedocs.io/en/latest/installing_docker.html#upgrading>`_
for more details!

Happy testing!

---

If you like what we're doing and how Kiwi TCMS supports various communities
please help us grow!

- `Give ‚≠ê on GitHub <https://github.com/kiwitcms/Kiwi/stargazers>`_;
- `Give üëç on GitLab <https://gitlab.com/gitlab-org/gitlab/-/issues/334558>`_;
- `Donate via Open Collective <https://opencollective.com/kiwitcms/donate>`_ as low as 1 EUR;
- `Join our newsletter <https://kiwitcms.us17.list-manage.com/subscribe/post?u=9b57a21155a3b7c655ae8f922&id=c970a37581>`_
  and follow all project news;
- `Become a contributor <https://kiwitcms.readthedocs.io/en/latest/contribution.html>`_
  and an awesome open source hacker;
- `Become a subscriber </#subscriptions>`_ and help us sustain development
