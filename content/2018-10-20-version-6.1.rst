Kiwi TCMS 6.1
#############

:headline: updates and database migrations
:date: 2018-10-20 14:40
:comments: true
:tags: releases

We're happy to announce Kiwi TCMS version 6.1! This release
introduces new database migrations,
internal updates and bug fixes. It is a small release designed
to minimize the number of database migrations by squashing them together.
You can explore everything at
`https://public.tenant.kiwitcms.org <https://public.tenant.kiwitcms.org/login/github-app/>`_.


**NOTE:** there is the 6.0.1 release which resolves an upgrade problem
caused by non-applied migrations which have been later squashed and
released in the same release! It is best to jump through the intermediate
releases to ensure a smooth upgrade!


Supported upgrade paths::

    5.3   (or older) -> 5.3.1
    5.3.1 (or newer) -> 6.0.1
    6.0.1            -> 6.1

Docker images::

    pub.kiwitcms.eu/kiwitcms/kiwi       latest  b559123d25b0    970.2 MB
    pub.kiwitcms.eu/kiwitcms/kiwi       6.1     b559123d25b0    970.2 MB
    pub.kiwitcms.eu/kiwitcms/kiwi       6.0.1   87b24d94197d    970.1 MB
    pub.kiwitcms.eu/kiwitcms/kiwi       5.3.1   a420465852be    976.8 MB



Changes since Kiwi TCMS 6.0
---------------------------

Improvements
~~~~~~~~~~~~

- Update `Jira from 1.0.10 to 2.0.0 <https://github.com/pycontribs/jira>`_
- Update to `Patternfly 3.55.0 <https://github.com/patternfly/patternfly/releases>`_
- Use button instead of HTML link for deleting test plan (Oleg Kainov)
- New middleware that will check missing settings. At the moment will only
  check Base URL configuration which often gets forgotten!


Bug fixes
~~~~~~~~~

- Hot-fix for error caused by the API method ``TestRun.update``. Error was
  initially reported on
  `StackOverflow <https://stackoverflow.com/questions/52865463/>`_.
  This patch makes it possible to use the API without crashing however the
  ``TestRun.update`` method doesn't handle the ``stop_date`` field at the moment!


Translations
~~~~~~~~~~~~

- Updated `Slovenian translation <https://crowdin.com/project/kiwitcms/sl#>`_
- Updated `German translation <https://crowdin.com/project/kiwitcms/de#>`_
- Updated translation source strings


Refactoring
~~~~~~~~~~~

- Fix pylint errors (Ivaylo Ivanov)
- Remove unused ``TestRun.list`` and ``TestCase.list_confirmed`` methods
- Remove unused ``plan_by_id_or_name()`` and ``is_int()``. Fixes
  `Issue #269 <https://github.com/kiwitcms/Kiwi/issues/269>`_


Database
~~~~~~~~

- Rename ``tcms.core.contrib.auth`` to ``tcms.kiwi_auth``
- Remove field ``user`` from ``TestCaseTag``, ``TestRunTag`` and ``TestPlanTag``
  models
- Squash migrations for ``management`` app
- Squash migrations for ``testcases`` app
- Squash migrations for ``testplans`` app
- Squash migrations for ``testruns`` app



How to upgrade
---------------

If you are using Kiwi TCMS as a Docker container then::

    cd Kiwi/
    git pull
    docker-compose down
    docker pull pub.kiwitcms.eu/kiwitcms/kiwi
    docker pull centos/mariadb
    docker-compose up -d
    docker exec -it kiwi_web /Kiwi/manage.py migrate

Don't forget to `backup <{filename}2018-07-30-docker-backup.markdown>`_
before upgrade!


Subscription based online service
---------------------------------

We are planning to convert
`https://public.tenant.kiwitcms.org <https://public.tenant.kiwitcms.org/login/github-app/>`_ into
a subscription based service for people who don't want to bother installing
Kiwi TCMS on their own systems and just want to use it for test collaboration
with their team.

The income from this service will go towards covering operating costs and
supporting the
`development team <{filename}pages/team.html>`_. Watch this
blog for further announcements about this. Meanwhile you may share your
thoughts via
`Issue #515 <https://github.com/kiwitcms/Kiwi/issues/515>`_.


Plans to remove deprecated functionality
----------------------------------------

``TestRun.product_version`` will be removed from the database schema in favor of
``TestRun.plan.product_version``! With the latest web interface it is not possible
to select a product version different than the one selected in the Test Plan.
Test runs should only be able to select product builds (after
`Issue #246 <https://github.com/kiwitcms/Kiwi/issues/246>`_ is fixed).
