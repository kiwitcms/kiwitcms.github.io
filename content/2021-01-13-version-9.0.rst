Kiwi TCMS 9.0
#############

:headline: contains backwards incompatible changes
:date: 2021-01-13 14:20
:comments: true
:tags: releases


We're happy to announce Kiwi TCMS version 9.0!

**IMPORTANT:** this is a major release which includes backwards incompatible
database and API changes, improvements, bug fixes, translation updates,
new tests and internal refactoring.
It is the eight release to include contributions via our
`open source bounty program </blog/tags/bounty-program/>`_.

This is the third release after
`Kiwi TCMS reached 200K pulls <{filename}2020-10-26-200K-celebration.markdown>`_
on Docker Hub!

You can explore everything at
`https://public.tenant.kiwitcms.org <https://public.tenant.kiwitcms.org/>`_!


Supported upgrade paths::

    5.3   (or older) -> 5.3.1
    5.3.1 (or newer) -> 6.0.1
    6.0.1            -> 6.1
    6.1              -> 6.1.1
    6.1.1            -> 6.2 (or newer)

Docker images::

    pub.kiwitcms.eu/kiwitcms/kiwi       latest  f98908772a2a    695 MB
    pub.kiwitcms.eu/kiwitcms/kiwi       6.2     7870085ad415    957 MB
    pub.kiwitcms.eu/kiwitcms/kiwi       6.1.1   49fa42ddfe4d    955 MB
    pub.kiwitcms.eu/kiwitcms/kiwi       6.1     b559123d25b0    970 MB
    pub.kiwitcms.eu/kiwitcms/kiwi       6.0.1   87b24d94197d    970 MB
    pub.kiwitcms.eu/kiwitcms/kiwi       5.3.1   a420465852be    976 MB


Changes since Kiwi TCMS 8.9
---------------------------

Improvements
~~~~~~~~~~~~

- Update django from 3.1.4 to 3.1.5
- Update django-contrib-comments from 1.9.2 to 2.0.0
- Update pygithub from 1.53 to 1.54.1
- Update pygments from 2.7.3 to 2.7.4
- Update mysqlclient from 2.0.1 to 2.0.3
- Update node_modules/prismjs from 1.22.0 to 1.23.0
- Update node_modules/marked from 1.2.5 to 1.2.7
- Implement 'Select all' for TestCase Search page. Resolves
  `Issue #2103 <https://github.com/kiwitcms/Kiwi/issues/2103>`_ (Bryan Mutai)
- Change ON/OFF button messages for several buttons (Krum Petkov)
- Remove ``delete_selected`` action from admin pages
- Show active test runs in TestPlan page
- Hide irrelevant Version & Build selectors for Testing breakdown telemetry
- Allow ``running`` to be passed as URL query param to TestRun Search page


Settings
~~~~~~~~

- Remove unused ``kiwi.rpc`` log handler from ``LOGGING`` setting


Database
~~~~~~~~

**Warning:** Contains backwards incompatible changes.

- Replace ``Build.product`` with ``Build.version``. Closes
  `Issue #246 <https://github.com/kiwitcms/Kiwi/issues/246>`_. Build objects
  are now associated with Version objects, not with Product objects!

  **Warning:**

     After migration existing builds will point to the "unspecified" version!
     If you want your telemetry to be accurate you will have to update these
     objects manually and point them to the appropriate version value!

- Rename related_name for TestExecution model: ``case_run`` -> ``executions``
- Rename related_name for TestCase model: ``case`` -> ``cases``


API
~~~

**Warning:** Contains backwards incompatible changes.

- Methods ``Build.filter``, ``Build.create`` and ``Build.update`` replace the
  ``product`` field with a ``version`` field


Bug fixes
~~~~~~~~~

- Display raw Markdown text before rendering to fix a bug where anonymous users
  don't see any text on the screen even if they are allowed to view an object


Refactoring & testing
~~~~~~~~~~~~~~~~~~~~~

- Add tests for ``tcms.core.middleware``. Fixes
  `Issue #1605 <https://github.com/kiwitcms/Kiwi/issues/1605>`_ (Gagan Deep)
- Add tests for ``tcms.handlers``. Fixes
  `Issue #1611 <https://github.com/kiwitcms/Kiwi/issues/1611>`_ (Gagan Deep)
- Add tests for ``tcms.kiwi_auth.views``. Fixes
  `Issue #1608 <https://github.com/kiwitcms/Kiwi/issues/1608>`_
  (Abhishek Chaurasia)
- Update pip during bugtracker integration tests to fix dependency issues
- Reformat all files with black and isort. Closes
  `Issue #1193 <https://github.com/kiwitcms/Kiwi/issues/1193>`_
- Refactor ``TestExecution.get_bugs()`` to use ``TestExecution.links()``
- Add return statement for invalid form to make pylint happy
- Make ``Bug.assignee`` field a ``UserField``
- Replace deprecated ``ugettext_lazy`` with ``gettext_lazy``
- Fixes for Azure Boards integration tests
- Remove ``CsrfDisableMiddleware``. Closes
  `Issue #297 <https://github.com/kiwitcms/Kiwi/issues/297>`_
- Remove unused methods & left-over views


Translations
~~~~~~~~~~~~

- Updated `Catalan translation <https://crowdin.com/project/kiwitcms/ca#>`_
- Updated `Chinese Simplified translation <https://crowdin.com/project/kiwitcms/zh-CN#>`_
- Updated `French translation <https://crowdin.com/project/kiwitcms/fr#>`_
- Updated `Hungarian translation <https://crowdin.com/project/kiwitcms/hu#>`_
- Updated `Japanese translation <https://crowdin.com/project/kiwitcms/ja#>`_
- Updated `Slovenian translation <https://crowdin.com/project/kiwitcms/sl#>`_


Kiwi TCMS Enterprise v9.0-mt
----------------------------

- Based on Kiwi TCMS v9.0
- Update kiwitcms-github-app from 1.2.1 to 1.2.2
- Update kiwitcms-tenants from 1.3.1 to 1.4.2

For more info see
https://github.com/kiwitcms/enterprise#v90-mt-12-jan-2021


Automation framework plugins
----------------------------

The following
`test automation framework plugins
<https://kiwitcms.readthedocs.io/en/latest/plugins/automation-frameworks.html>`_
have been upgraded to work with Kiwi TCMS v9.0:

- `tap-plugin <https://github.com/kiwitcms/tap-plugin>`_
- `junit.xml-plugin <https://github.com/kiwitcms/junit.xml-plugin>`_
- `Robot Framework plugin <https://github.com/kiwitcms/robotframework-plugin>`_
- `Django plugin <https://github.com/kiwitcms/django-plugin>`_


How to upgrade
---------------

`Backup <{filename}2018-07-30-docker-backup.markdown>`_ first!
If you are using Kiwi TCMS as a Docker container then::

    cd path/containing/docker-compose/
    docker-compose down
    docker-compose pull
    docker-compose up -d
    docker exec -it kiwi_web /Kiwi/manage.py migrate

Refer to
`our documentation <https://kiwitcms.readthedocs.io/en/latest/installing_docker.html#upgrading>`_
for more details!

Happy testing!

---

If you like what we're doing and how Kiwi TCMS supports various communities
please help us!

- `Give ‚≠ê on GitHub <https://github.com/kiwitcms/Kiwi/stargazers>`_;
- `Nominate Kiwi TCMS as GitHub Stars <{filename}2020-09-04-nominate-github-star.markdown>`_;
- `Donate via Open Collective <https://opencollective.com/kiwitcms/donate>`_ as low as 1 EUR;
- `Join our newsletter <https://kiwitcms.us17.list-manage.com/subscribe/post?u=9b57a21155a3b7c655ae8f922&id=c970a37581>`_
  and follow all project news;
- `Become a contributor <https://kiwitcms.readthedocs.io/en/latest/contribution.html>`_
  and an awesome open source hacker;
- `Become a customer </#subscriptions>`_ and we'll share our profits with the community
