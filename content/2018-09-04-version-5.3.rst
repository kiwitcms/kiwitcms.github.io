Kiwi TCMS 5.3.1
###############

:headline: UI updates, subscriptions and deprecations
:date: 2018-09-04 23:00
:comments: true
:tags: releases

We're happy to announce Kiwi TCMS version 5.3.1! This release
brings lots of UI updates and removal of unused
and/or duplicated functionality and source code. Many pages have been redesigned
with the Patternfly library to have a modern look and feel which you can
experience at `https://public.tenant.kiwitcms.org <https://public.tenant.kiwitcms.org/login/github-app/>`_.


This will be the last release to carry around squashed migrations. In version
6.0 older migrations will be deleted and replaced with their squashed equivalents.
Upgrades from versions < 5.3 to 6.0 will break without an intermediate upgrade to 5.3.1!

Use ``pub.kiwitcms.eu/kiwitcms/kiwi:5.3.1`` from Docker Hub when upgrading at some point in the future!

Docker images::

    pub.kiwitcms.eu/kiwitcms/kiwi        5.3.1               a420465852be        976.8 MB
    pub.kiwitcms.eu/kiwitcms/kiwi        latest              a420465852be        976.8 MB


Changes since Kiwi TCMS 5.2
---------------------------


Improvements
~~~~~~~~~~~~

- Update to `Django 2.1.1 <https://docs.djangoproject.com/en/2.1/releases/2.1.1/>`_
- Update Patternfly version. Fixes
  `Issue #381 <https://github.com/kiwitcms/Kiwi/issues/381>`_
- Replace TinyMCE with SimpleMDE markdown editor. Used for TestPlan text and
  TestCase action, setup, breakdown, effect fields
- Allow downstream builds to customize the login templates by
  providing ``registration/custom_login.html`` template. It can either
  override the entire login page or provide additional information inside
  the ``custom_login`` block!

Known issues
~~~~~~~~~~~~

- You may need to strip existing texts from HTML tags that were generated by
  TinyMCE. Either do this manually as you go along and use/edit records or in bulk via
  the API and tools like `html2text <https://pypi.org/project/html2text/>`_.
  We strongly advise you to `backup <{filename}2018-07-30-docker-backup.markdown>`_
  your database before attempting to automatically edit text fields!


Visual changes
~~~~~~~~~~~~~~

- Remove breadcrumbs at the top of pages. Only admin pages still have them
- Convert login and registration templates to Patternfly. Fixes
  `Issue #211 <https://github.com/kiwitcms/Kiwi/issues/211>`_
- Convert 404 and 500 templates to Patternfly
- Convert dashboard page to Patternfly
- Convert TestRun new, edit and clone pages to Patternfly. Fixes
  `Issue #17 <https://github.com/kiwitcms/Kiwi/issues/17>`_
- Convert Search Test Plans page to Patternfly
- Convert Search Test Runs page to Patternfly
- Convert Search Test Cases page to Patternfly
- TestPlan view page, Runs tab now re-uses the search form for test runs
  which is built using Patternfly
- Added pagination controls to pages with search results


Removed functionality
~~~~~~~~~~~~~~~~~~~~~

- When creating or editing TestRun

  - field ``estimated_time`` is scheduled for removal and is not shown
  - ``product_version`` is scheduled for removal in favor of
    ``TR.plan.product_version``
  - Product & Version can't be edited anymore. Must be set on the parent
    TestPlan instead. Still allows to specify builds

- Remove the ability to clone multiple TestPlans from search results
- Remove the ability to upload TestPlan document files in favor of
  the existing API
- Remove TestCase export to XML in favor of existing API
- Remove Advanced Search functionality. Fixes
  `Issue #448 <https://github.com/kiwitcms/Kiwi/issues/448>`_,
  `Issue #108 <https://github.com/kiwitcms/Kiwi/issues/108>`_
- Remove tech preview feature: Django Report Builder


Translations
~~~~~~~~~~~~

- Updated `German translation <https://crowdin.com/project/kiwitcms/de#>`_
- Updated `Slovenian translation <https://crowdin.com/project/kiwitcms/sl#>`_
- Marked more strings as translatable


Bug fixes
~~~~~~~~~

- Don't use ``get_full_url()`` where not needed. Closes
  `Issue #380 <https://github.com/kiwitcms/Kiwi/issues/380>`_
- Remove unused templates. Fixes
  `Issue #114 <https://github.com/kiwitcms/Kiwi/issues/114>`_
- Submit filter form when clicking on tag value. Fixes
  `Issue #426 <https://github.com/kiwitcms/Kiwi/issues/426>`_
- Update ``TestCaseRun.tested_by`` when setting status. Fixes
  `Issue #459 <https://github.com/kiwitcms/Kiwi/issues/459>`_
- Add tests for ``KiwiUserAdmin``. Closes
  `Issue #489 <https://github.com/kiwitcms/Kiwi/issues/489>`_


Settings
~~~~~~~~

- The following settings have been removed ``MOTD_LOGIN``, ``WELCOME_MESSAGE``
  and ``TINYMCE_DEFAULT_CONFIG``


Refactoring
~~~~~~~~~~~

- Fix pylint errors (Anton Sankov, Ivaylo Ivanov)
- Remove lots of unused functions and classes
- Remove old or unnecessary templates
- Remove ``html2text`` dependency
- Remove unused CSS and vendored-in JavaScript libraries
- Add JavaScript JSON-RPC client which is now used by the front-end to
  communicate with the existing JSON-RPC API on the back-end. This
  replaces many 'ajax' views which are only used to render the UI and were
  duplicating functionality with existing API
- Non ``dist/`` files are no longer removed from ``node_modules/`` when building
  a docker image because packages like ``moment.js`` and ``bootstrap-datetimepicker.js``
  don't ship their files in ``dist/``
- Convert TestPlans.TreeView to JSON RPC



How to upgrade
---------------

If you are using Kiwi TCMS as a Docker container then::

    cd Kiwi/
    git pull
    docker-compose down
    docker pull pub.kiwitcms.eu/kiwitcms/kiwi
    docker pull centos/mariadb
    docker-compose up -d
    docker exec -it kiwi_web /Kiwi/manage.py migrate

Don't forget to `backup <{filename}2018-07-30-docker-backup.markdown>`_
before upgrade!


Ask your questions on StackOverflow
-----------------------------------

Kiwi TCMS is now using the
`'kiwi-tcms' <https://stackoverflow.com/questions/tagged/kiwi-tcms>`_
tag on StackOverflow to track questions. Please submit your support requests
and general questions to
`StackOverflow <https://stackoverflow.com/questions/tagged/kiwi-tcms>`_ tagged
with the 'kiwi-tcms' tag! Support requests via GitHub or email will not be answered
anymore (GitHub issues are for bugs or feature discussions only)!


Subscription based online service
---------------------------------

We are planning to convert
`https://public.tenant.kiwitcms.org <https://public.tenant.kiwitcms.org/login/github-app/>`_ into
a subscription based service for people who don't want to bother installing
Kiwi TCMS on their own systems and just want to use it for test collaboration
with their team.

The income from this service will go towards covering operating costs and
supporting the
`development team <https://github.com/orgs/kiwitcms/people>`_. Watch this
blog for further announcements about this. Meanwhile you may share your
thoughts via
`Issue #515 <https://github.com/kiwitcms/Kiwi/issues/515>`_.


Plans to remove deprecated functionality
----------------------------------------

``TestRun.product_version`` will be removed from the database schema in favor of
``TestRun.plan.product_version``! With the latest web interface it is not possible
to select a product version different than the one selected in the Test Plan.
Test runs should only be able to select product builds (after
`Issue #246 <https://github.com/kiwitcms/Kiwi/issues/246>`_ is fixed).

``TestRun.estimated_time`` is scheduled for removal if not used. Objections
and use-cases must be shared via
`Issue #514 <https://github.com/kiwitcms/Kiwi/issues/514>`_.

``EnvGroup`` and ``EnvProperty`` models are scheduled for removal in favor
of ``Tag``. Internally tags are referenced in more places inside Kiwi TCMS'
source code and they appear to be more fully developed. On the other hand
while environment appears very similar to tags it is not exactly the same.
Ongoing discussion is happening via
`Issue #484 <https://github.com/kiwitcms/Kiwi/issues/484>`_.
